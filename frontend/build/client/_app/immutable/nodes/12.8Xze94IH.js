import{c as re,l as te,a as l,f as q,t as S}from"../chunks/mVdtGE8-.js";import{i as se}from"../chunks/DfpQQ0Vj.js";import{p as oe,o as ie,l as ne,g as le,j as k,u as I,k as r,a as de,e as pe,c as t,m,v as ce,f as n,q as o,F as v,$ as me,r as s,t as f,w as ue}from"../chunks/CK0-DIe0.js";import{a as P,e as fe}from"../chunks/Bv0kf0zg.js";import{s as ve}from"../chunks/Bwj96XKz.js";import{i as j}from"../chunks/BhPWbYAn.js";import{v as ge}from"../chunks/DTEFG1b5.js";import{h as ye}from"../chunks/CBTfresD.js";import{r as M,l as _e}from"../chunks/BSTdbr_g.js";import{b as N}from"../chunks/DesAynyD.js";import{p as be}from"../chunks/CdEA5IGF.js";import{s as xe,a as he}from"../chunks/BKTEqjJl.js";import{g as W}from"../chunks/DdYhDDtT.js";import{p as C}from"../chunks/BBQ4KvbY.js";import{a as we,b as $e}from"../chunks/DtlIlvpb.js";i[v]="src/routes/login/+page.svelte";var Se=P(q('<div class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded text-sm"> </div>'),i[v],[[77,4]]),ke=P(q("<span>Signing in...</span>"),i[v],[[118,6]]),je=P(q('<div class="min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8"><div class="max-w-md w-full space-y-8"><div><h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">Sign in to your account</h2> <p class="mt-2 text-center text-sm text-gray-600"><!></p></div> <form class="mt-8 space-y-6"><!> <div class="rounded-md shadow-sm -space-y-px"><div><label for="email" class="sr-only">Email address</label> <input id="email" name="email" type="email" autocomplete="email" required class="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm" placeholder="Email address"/></div> <div><label for="password" class="sr-only">Password</label> <input id="password" name="password" type="password" autocomplete="current-password" required class="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm" placeholder="Password"/></div></div> <div><button type="submit" class="group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"><!></button></div></form></div></div>'),i[v],[[62,0,[[63,1,[[64,2,[[65,3],[66,3]]],[75,2,[[82,3,[[83,4,[[84,5],[85,5]]],[96,4,[[97,5],[98,5]]]]],[111,3,[[112,4]]]]]]]]]]);function i(J,B){re(new.target),oe(B,!1,i);const E=()=>(ge(C,"page"),he(C,"$page",G)),[G,H]=xe(),d=m();let g=m(""),y=m(""),p=m(""),u=m(!1);ie(()=>{we()});async function K(e){e.preventDefault(),o(u,!0),o(p,"");try{const a=(await f(fetch("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r(g),password:r(y)})})))(),c=(await f(a.json()))();if(!a.ok){o(p,c.error||"Login failed");return}$e.set({authenticated:!0,user:c.user}),ue(c.role,"admin")?(await f(W(r(d).startsWith("/admin")?r(d):"/admin")))():(await f(W("/owner")))()}catch(a){o(p,"Login failed. Please try again."),console.error(..._e("error",a))}finally{o(u,!1)}}ne(()=>E(),()=>{o(d,E().url.searchParams.get("redirect")||"/admin")}),le();var Q={...te()};se();var _=je();ye("1x05zx6",e=>{pe(()=>{me.title="Sign In - OpenShutter"})});var z=t(_),b=t(z),A=n(t(b),2),R=t(A);{var U=e=>{var a=S("Admin access required");l(e,a)},V=e=>{var a=S("Access your gallery");l(e,a)};k(()=>j(R,e=>{r(d),ce(()=>r(d).startsWith("/admin"))?e(U):e(V,!1)}),"if",i,67,4)}s(A),s(b);var x=n(b,2),L=t(x);{var X=e=>{var a=Se(),c=t(a,!0);s(a),I(()=>ve(c,r(p))),l(e,a)};k(()=>j(L,e=>{r(p)&&e(X)}),"if",i,76,3)}var h=n(L,2),w=t(h),O=n(t(w),2);M(O),s(w);var T=n(w,2),D=n(t(T),2);M(D),s(T),s(h);var F=n(h,2),$=t(F),Y=t($);{var Z=e=>{var a=ke();l(e,a)},ee=e=>{var a=S("Sign in");l(e,a)};k(()=>j(Y,e=>{r(u)?e(Z):e(ee,!1)}),"if",i,117,5)}s($),s(F),s(x),s(z),s(_),I(()=>$.disabled=r(u)),N(O,function(){return r(g)},function(a){o(g,a)}),N(D,function(){return r(y)},function(a){o(y,a)}),fe("submit",x,be(K)),l(J,_);var ae=de(Q);return H(),ae}export{i as component};
